!function(t){function e(t){var e=p.createElement("script");e.setAttribute("type","text/javascript"),e.setAttribute("src",t),p.getElementsByTagName("head")[0].appendChild(e)}function n(){n.done||(n.done=!0,w=!0,m=!1,y.each(b,function(t){t._dom_loaded()}))}function o(){try{p.documentElement.doScroll("left")}catch(t){return void setTimeout(o,1)}n()}var i=[],r=Array.prototype,a=Function.prototype,c=Object.prototype,s=r.slice,u=c.toString,f=c.hasOwnProperty,l=window.console,d=window.navigator,p=window.document,h=d.userAgent,_="http:"==p.location.protocol?"http://":"https://",g=t&&t.__SV||0,v=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,m=!v&&-1==h.indexOf("MSIE")&&-1==h.indexOf("Mozilla"),y={},k={api_host:_+"api.cooladata.com",loaded:function(){},img:!1,http_post:!1,track_pageload:!1,cookie_expiration:365,disable_cookie:!1,izzyClick:!1,cookie_name:"cd_user_id",izzyScriptUrl:"ezsdk.cooladata.com/[APPKEY]/Izzycdext.js"},w=!1;!function(){a.bind;var t=r.forEach,e=(r.indexOf,Array.isArray),n={},o=y.each=function(e,o,i){if(null!=e)if(t&&e.forEach===t)e.forEach(o,i);else if(e.length===+e.length){for(var r=0,a=e.length;r<a;r++)if(r in e&&o.call(i,e[r],r,e)===n)return}else for(var c in e)if(f.call(e,c)&&o.call(i,e[c],c,e)===n)return};y.extend=function(t){return o(s.call(arguments,1),function(e){for(var n in e)void 0!==e[n]&&(t[n]=e[n])}),t},y.isArray=e||function(t){return"[object Array]"===u.call(t)},y.isFunction=function(t){try{return/^\s*\bfunction\b/.test(t)}catch(t){return!1}},y.isArguments=function(t){return!(!t||!f.call(t,"callee"))},y.toArray=function(t){return t?t.toArray?t.toArray():y.isArray(t)?s.call(t):y.isArguments(t)?s.call(t):y.values(t):[]},y.values=function(t){var e=[];return null==t?e:(o(t,function(t){e[e.length]=t}),e)}}(),y.isObject=function(t){return t===Object(t)&&!y.isArray(t)},y.isUndefined=function(t){return void 0===t},y.isString=function(t){return"[object String]"==u.call(t)},y.JSONEncode=function(t){var e=function(t){var e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return e.lastIndex=0,e.test(t)?'"'+t.replace(e,function(t){var e=n[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'},n=function(t,o){var i="",r=0,a="",c="",s=0,l=i,d=[],p=o[t];switch(p&&"object"==typeof p&&"function"==typeof p.toJSON&&(p=p.toJSON(t)),typeof p){case"string":return e(p);case"number":return isFinite(p)?String(p):"null";case"boolean":case"null":return String(p);case"object":if(!p)return"null";if(i+="    ",d=[],"[object Array]"===u.apply(p)){for(s=p.length,r=0;r<s;r+=1)d[r]=n(r,p)||"null";return c=0===d.length?"[]":i?"[\n"+i+d.join(",\n"+i)+"\n"+l+"]":"["+d.join(",")+"]",i=l,c}for(a in p)f.call(p,a)&&(c=n(a,p))&&d.push(e(a)+(i?": ":":")+c);return c=0===d.length?"{}":i?"{"+d.join(",")+l+"}":"{"+d.join(",")+"}",i=l,c}};return n("",{"":t})},y.strip_empty_properties=function(t){var e={};return y.each(t,function(t,n){y.isString(t)&&t.length>0&&(e[n]=t)}),e},y.base64Encode=function(t){var e={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(t){var n,o,i,r,a,c,s,u="",f=0;for(t=e._utf8_encode(t);f<t.length;)r=(n=t.charCodeAt(f++))>>2,a=(3&n)<<4|(o=t.charCodeAt(f++))>>4,c=(15&o)<<2|(i=t.charCodeAt(f++))>>6,s=63&i,isNaN(o)?c=s=64:isNaN(i)&&(s=64),u=u+this._keyStr.charAt(r)+this._keyStr.charAt(a)+this._keyStr.charAt(c)+this._keyStr.charAt(s);return u},_utf8_encode:function(t){t=t.replace(/\r\n/g,"\n");for(var e="",n=0;n<t.length;n++){var o=t.charCodeAt(n);o<128?e+=String.fromCharCode(o):o>127&&o<2048?(e+=String.fromCharCode(o>>6|192),e+=String.fromCharCode(63&o|128)):(e+=String.fromCharCode(o>>12|224),e+=String.fromCharCode(o>>6&63|128),e+=String.fromCharCode(63&o|128))}return e}};return e.encode(t)},y.utf8Encode=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",n=0;n<t.length;n++){var o=t.charCodeAt(n);o<128?e+=String.fromCharCode(o):o>127&&o<2048?(e+=String.fromCharCode(o>>6|192),e+=String.fromCharCode(63&o|128)):(e+=String.fromCharCode(o>>12|224),e+=String.fromCharCode(o>>6&63|128),e+=String.fromCharCode(63&o|128))}return e},y.HTTPBuildQuery=function(t,e){var n,o,i=[];return void 0===e&&(e="&"),y.each(t,function(t,e){n=encodeURIComponent(t.toString()),o=encodeURIComponent(e),i[i.length]=o+"="+n}),i.join(e)},y.UUID=function(){var t=function(){for(var t=1*new Date,e=0;t==1*new Date;)e++;return t.toString(16)+e.toString(16)},e=function(){return Math.random().toString(16).replace(".","")},n=function(t){function e(t,e){var n,o=0;for(n=0;n<e.length;n++)o|=r[n]<<8*n;return t^o}var n,o,i=h,r=[],a=0;for(n=0;n<i.length;n++)o=i.charCodeAt(n),r.unshift(255&o),r.length>=4&&(a=e(a,r),r=[]);return r.length>0&&(a=e(a,r)),a.toString(16)};return function(){var o=(screen.height*screen.width).toString(16);return t()+"-"+e()+"-"+n()+"-"+o+"-"+t()}}(),y.getQueryParam=function(t,e){var n="[\\?&]"+(e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"))+"=([^&#]*)",o=new RegExp(n).exec(t);return null===o||o&&"string"!=typeof o[1]&&o[1].length?"":decodeURIComponent(o[1]).replace(/\+/g," ")},y.register_event=function(){function t(t,n,o){return function(i){if(i=i||e(window.event)){var r,a,c=!0;return y.isFunction(o)&&(r=o(i)),a=n.call(t,i),!1!==r&&!1!==a||(c=!1),c}}}function e(t){return t&&(t.preventDefault=e.preventDefault,t.stopPropagation=e.stopPropagation),t}return e.preventDefault=function(){this.returnValue=!1},e.stopPropagation=function(){this.cancelBubble=!0},function(e,n,o,i){if(e)if(e.addEventListener&&!i)e.addEventListener(n,o,!1);else{var r="on"+n,a=e[r];e[r]=t(e,o,a)}else l.log("No valid element provided to register_event")}}(),y.info={campaignParams:function(){var t="utm_source utm_medium utm_campaign utm_content utm_term".split(" "),e="",n={};return y.each(t,function(t){(e=y.getQueryParam(p.URL,t)).length&&(n[t]=e)}),n},referringDomain:function(t){var e=t.split("/");return e.length>=3?e[2]:""},properties:function(){return y.extend(y.strip_empty_properties({session_screen_size:window.screen.width+"x"+window.screen.height,session_dua:d.userAgent,session_platform:d.platform,referring_url:p.referrer,referring_domain:y.info.referringDomain(p.referrer),page_title:p.title,page_url:p.location.href}),{tracker_type:"javascript",tracker_version:"2.1.19"})},pageviewInfo:function(t){return y.strip_empty_properties({event_timestamp_epoch:1*new Date})}};var S={critical:function(){if(!y.isUndefined(l)&&l){var t=["Cooladata error:"].concat(y.toArray(arguments));try{l.error.apply(l,t)}catch(e){y.each(t,function(t){l.error(t)})}}}},C=function(e,n,o){var i,r="cooladata"===o?t:t[o];{if(!r||y.isArray(r))return(i=new E)._init(e,n,o),y.isUndefined(r)||i._execute_array(r),i;l.log("You have already initialized "+o)}},E=function(){};if(E.prototype.init=function(e,n,o){if(void 0!==o){if("cooladata"!==o){var i=C(e,n,o);return t[o]=i,i._loaded(),i}l.log("You must initialize the main cooladata object right after you include the Cooladata js snippet")}else l.log("You must name your new library: init(token, config, name)")},E.prototype._init=function(t){if(this.__loaded=!0,this.__SV=!0,this.config={},this.set_config(y.extend({},k,{token:t.app_key,img:t.img_src_get_request,session_id:t.session_id,http_post:t.http_post,track_pageload:t.track_pageload,disable_cookie:t.disable_cookie})),t.api_host&&this.set_config({api_host:_+t.api_host}),t.izzyClick&&e(_+k.izzyScriptUrl.replace("[APPKEY]",t.app_key)),t.cookie_expiration&&this.set_config({cookie_expiration:t.cookie_expiration}),t.user_id)this.set_config({user_id:t.user_id});else if(this.get_config("disable_cookie"))this.set_config({user_id:y.UUID()});else{var n=this.get_config("cookie_name"),o=this.getCookie(n);""==o?(this.setCookie(n),""==(o=this.getCookie(n))?this.set_config({user_id:y.UUID()}):this.set_config({user_id:o})):this.set_config({user_id:o})}this.__dom_loaded_queue=[],this.__request_queue=[],t.custom_event_handler&&(this.__customEventHandler=t.custom_event_handler)},E.prototype.getCookie=function(t){for(var e=t+"=",n=p.cookie.split(";"),o=0;o<n.length;o++){for(var i=n[o];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(e))return i.substring(e.length,i.length)}return""},E.prototype.setCookie=function(t){var e=this.get_config("cookie_expiration"),n=new Date;n.setTime(n.getTime()+24*e*60*60*1e3);var o="; expires="+n.toGMTString(),i=["com","org","net","int","edu","gov","mil","biz"],r=window.location.host.split("."),a="";if("www"==r[0]||4==r.length)r.shift(),a=r.join(".");else switch(r.length){case 2:a=r.join(".");break;case 3:for(var c=i.length;c--;)if(i[c]===r[2]){r.shift(),a=r.join(".");break}""==a&&(a=r.join("."))}p.cookie=t+"="+y.UUID()+o+";domain=."+a+";path=/"},E.prototype._loaded=function(){this.get_config("loaded")(this),this.get_config("track_pageload")&&this.track_pageload()},E.prototype._dom_loaded=function(){y.each(this.__dom_loaded_queue,function(t){this._track_dom.apply(this,t)},this),y.each(this.__request_queue,function(t){this._send_request.apply(this,t)},this),delete this.__dom_loaded_queue,delete this.__request_queue},E.prototype._track_dom=function(t,e){if(this.get_config("img"))return l.log("You can't use DOM tracking functions with img = true."),!1;if(!w)return this.__dom_loaded_queue.push([t,e]),!1;var n=(new t).init(this);return n.track.apply(n,e)},E.prototype.trackEventLater=function(t,e){if(void 0!==t){e=e||{};var n=new Date,o=y.extend({},y.info.properties(),y.info.campaignParams(),{event_name:t,event_timestamp_epoch:n.getTime().toString(),event_timezone_offset:n.getTimezoneOffset()/60*-1,user_id:this.get_config("user_id"),session_id:this.get_config("session_id")});o=y.extend(o,e),i.push(o)}else l.log("No event name provided to cooladata.trackEventLater")},E.prototype.flush=function(){this.get_config("api_host"),this.get_config("token");var t={events:i},e=y.JSONEncode(t);this._send_request(e),i=[]},E.prototype._onError=function(t,e){},E.prototype._send_request=function(t,e){if(m)this.__request_queue.push(arguments);else{var n=function(){var t=window.navigator.userAgent;return t.indexOf("MSIE ")>-1&&1!==t.split("MSIE ")[1].charAt(0)},o=!1;if(t.length>1400&&(o=!0),this.__customEventHandler&&this.__customEventHandler.handleRequest){var i=null;return o||!n()&&!this.get_config("img")?v&&(i=this.get_config("http_post")||o?"post":"get"):i="image",void this.__customEventHandler.handleRequest(this,t,i)}var r=this.get_config("api_host")+"/v1/"+this.get_config("token")+"/track";if(o||!n()&&!this.get_config("img"))if(v){var a=null;this.get_config("http_post")||o?a="data="+encodeURIComponent(t):(t={data:y.base64Encode(t)},r+="?"+y.HTTPBuildQuery(t));var c=new XMLHttpRequest;this.get_config("http_post")||o?(c.open("POST",r,!0),c.setRequestHeader("Content-type","application/x-www-form-urlencoded")):c.open("GET",r,!0),c.withCredentials=!0,c.onreadystatechange=function(t){if(4===c.readyState)if(200===c.status)e&&e();else{var n="Bad HTTP status: "+c.status+" "+c.statusText;l.log(n)}},c.send(a)}else{var s=p.createElement("script");s.type="text/javascript",s.async=!0,s.defer=!0,s.src=r;var u=p.getElementsByTagName("script")[0];u.parentNode.insertBefore(s,u)}else{var f=this;r=this.get_config("api_host")+"/egw/5/"+this.get_config("token")+"/track/__cool.gif",r+="?data="+(t=y.base64Encode(t));var d=p.createElement("img");d.onerror=function(){f._onError(t,e)},d.width=1,d.height=1,d.src=r}}},E.prototype._execute_array=function(t){var e,n=[],o=[],i=[];y.each(t,function(t){t&&(e=t[0],"function"==typeof t?t.call(this):y.isArray(t)&&"alias"===e?n.push(t):y.isArray(t)&&-1!=e.indexOf("track")&&"function"==typeof this[e]?i.push(t):o.push(t))},this);var r=function(t,e){y.each(t,function(t){this[t[0]].apply(this,t.slice(1))},e)};r(n,this),r(o,this),r(i,this)},E.prototype.push=function(t){this._execute_array([t])},E.prototype.trackEvent=function(t,e,n){if(void 0!==t){e=e||{};var o=new Date,i=y.extend({},y.info.properties(),y.info.campaignParams(),{event_name:t,event_timestamp_epoch:o.getTime().toString(),event_timezone_offset:o.getTimezoneOffset()/60*-1,user_id:this.get_config("user_id"),session_id:this.get_config("session_id")});i={events:[i=y.extend(i,e)]};var r=y.JSONEncode(i);this._send_request(r,n)}else l.log("No event name provided to cooladata.trackEvent")},E.prototype.track_pageload=function(t){void 0===t&&(t=p.location.href),this.trackEvent("page_load",y.info.pageviewInfo(t))},E.prototype.set_config=function(t){y.isObject(t)&&y.extend(this.config,t)},E.prototype.get_config=function(t){return this.config[t]},E.prototype.toString=function(){var t=this.get_config("name");return"cooladata"!==t&&(t="cooladata."+t),t},y.toArray=y.toArray,y.isObject=y.isObject,y.JSONEncode=y.JSONEncode,y.info=y.info,E.prototype.init=E.prototype.init,E.prototype.track_event=E.prototype.trackEvent,E.prototype.track_event_later=E.prototype.trackEventLater,E.prototype.flush=E.prototype.flush,E.prototype.track_pageload=E.prototype.track_pageload,E.prototype.set_config=E.prototype.set_config,E.prototype.get_config=E.prototype.get_config,E.prototype.toString=E.prototype.toString,y.isUndefined(t))S.critical("'cooladata' object not initialized. Ensure you are using the latest version of the Cooladata JS Library along with the snippet we provide.");else if(t.__loaded||t.config)l.log("Cooladata library has already been downloaded at least once.");else if(g<1.1)l.critical("Version mismatch; please ensure you're using the latest version of the Cooladata code snippet.");else{var b={};y.each(t._i,function(t){var e,n;t&&y.isArray(t)&&(e=t[t.length-1],n=C.apply(this,t),b[e]=n)});var A=function(){y.each(b,function(e,n){"cooladata"!==n&&(t[n]=e)}),t._=y};if(t.init=function(e,n,o){if(o)t[o]||(t[o]=b[o]=C(e,n,o),t[o]._loaded());else{var i=t;b.cooladata?i=b.cooladata:e&&(i=C(e,n,"cooladata"))._loaded(),window.cooladata=t=i,A()}},t.init(),y.each(b,function(t){t._loaded()}),p.addEventListener)"complete"==p.readyState?n():p.addEventListener("DOMContentLoaded",n,!1);else if(p.attachEvent){p.attachEvent("onreadystatechange",n);var x=!1;try{x=null==window.frameElement}catch(t){}p.documentElement.doScroll&&x&&o()}y.register_event(window,"load",n,!0)}}(window.cooladata);
