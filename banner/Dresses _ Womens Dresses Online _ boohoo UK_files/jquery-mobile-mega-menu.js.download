/*!
jQuery Plugin Mobile Mega Menu
Blake Cerecero
Blake@DigitalBlake.com
http://DigitalBlake.com
@blakecerecero
*/'use strict';(function($){jQuery.fn.extend({mobileMegaMenu:function(options){var defaults={changeToggleText:false,enableWidgetRegion:false,prependCloseButton:false,toogleTextOnClose:'Close Menu',menuToggle:'toggle-menu'};var settings=$.extend(defaults,options);return this.each(function(){var animationSpeed=250,closeButton='<li><a class="close-button '+settings.menuToggle+'" href="#">Close Menu</a></li>',maxHeight=-1;var $menuRoot=$(this),$menuContainer=$('#mobile-navigation'),$currentText=$('a.'+settings.menuToggle).html(),$menuSelect=$('.js-menu-select');if($menuRoot.hasClass('menu-init')){return;}
$menuRoot.addClass('menu-init');var offersInclude=$('.mobile-category-offers-include');offersInclude.each(function(){var offers=$(this).parents('li').find('.category-offer-slot').html();$(this).prepend(offers);});$menuRoot.find('ul a').addClass('menu-item');$menuRoot.find('ul ul').before().siblings('a:first-of-type').parent('li').not('.link-tab').find('> a').addClass('has-next-button');if(settings.prependCloseButton){$menuRoot.find('ul').closest('ul').prepend(closeButton);}
var $toggleMenu=$('a.'+settings.menuToggle),$nextAction=$menuRoot.find('a.has-next-button'),$backAction=$menuRoot.find('a.back-button');if(settings.enableWidgetRegion){var widgets=$menuRoot.find('.widget-region').detach();$menuRoot.find('ul:first').append(widgets);}
$(".nav-offers").each(function(){var backButton=$(this).find('.back-button');if(backButton.length>0){$(this).find('.back-button:gt(0)').hide();}});var subLists=$menuRoot.find('ul');var resizeTimer;$(window).resize(function(){clearTimeout(resizeTimer);resizeTimer=setTimeout(function(){min_el_height();},500);});function min_el_height(){subLists.toArray().forEach(function(element){maxHeight=maxHeight>$(element).height()?maxHeight:$(element).height();});}
min_el_height();$toggleMenu.on('click',function(event){event.preventDefault();if(!$menuRoot.find('ul:first-child').hasClass('has-been-viewed')){$menuRoot.find('ul:first-child').toggleClass('is-in-view');}
if(settings.changeToggleText){if(!$menuRoot.hasClass('open')){$('a.'+settings.menuToggle).html(settings.toogleTextOnClose);}else if($menuRoot.hasClass('open')){$('a.'+settings.menuToggle).html($currentText);}}
$menuRoot.toggleClass('open');});$nextAction.on('click',function(event){var navLevel=$(this).siblings('ul:first-of-type').attr('nav-level');event.preventDefault();$menuContainer.scrollTop(0);$(this).siblings('ul:first-of-type').addClass('is-in-view');$(this).parents().siblings('li').find('ul').hide();$(this).parents('ul.is-in-view').find('[nav-level="'+navLevel+'"]').hide();$(this).siblings('ul').show();var $hasBeenViewed=$(this).closest('ul');$hasBeenViewed.addClass('has-been-viewed').removeClass('is-in-view');setTimeout(function(){$hasBeenViewed.addClass('transitioned');},300);$(this).parents('.menu-vertical').siblings('.menu-vertical').hide();if($menuSelect.length>0){$menuSelect.addClass('hidden');}});$backAction.on('click',function(event){event.preventDefault();$menuContainer.scrollTop(0);$(this).parents('.is-in-view').closest('ul.has-been-viewed').toggleClass('has-been-viewed is-in-view').removeClass('transitioned').promise().done(function(){$menuRoot.find('ul.is-in-view ul.is-in-view').toggleClass('is-in-view').hide();$menuRoot.find('.is-in-view .menu-vertical').show();if($menuSelect.length>0&&$menuRoot.find('.is-in-view').hasClass('menu-category')){$menuSelect.removeClass('hidden');}});});if($('html').hasClass('no-csstransforms')||$('html').hasClass('no-cssanimations')){$toggleMenu.on('click',function(event){event.preventDefault();$menuRoot.css('transform','none');if($menuRoot.hasClass('open')){$menuRoot.animate({left:0});}else{$menuRoot.animate({left:'-100%'});}});$nextAction.on('click',function(event){event.preventDefault();$menuRoot.find('.has-been-viewed').css('transform','none');$menuRoot.find('ul').animate({right:'+=100%'},animationSpeed);});$backAction.on('click',function(event){event.preventDefault();$menuRoot.find('.has-been-viewed').css('transform','none');$menuRoot.find('ul').animate({right:'-=100%'},animationSpeed);});}});}});}(jQuery));